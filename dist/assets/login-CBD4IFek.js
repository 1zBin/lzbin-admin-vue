var ae=Object.defineProperty;var re=(o,r,c)=>r in o?ae(o,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[r]=c;var v=(o,r,c)=>re(o,typeof r!="symbol"?r+"":r,c);import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang-CT2Tvg8M.js";import{_ as T,j as le,u as ce,k as de,f as ue,m as pe,g as me,n as _e,A as he}from"./index-B5vk6X0H.js";import{a4 as p,a2 as f,a7 as a,d as ge,V as fe,r as ve,s as k,f as we,ao as be,o as xe,u as e,j as ye,af as _,ab as $,k as n,ac as d,ae as ke,ag as M,F as z,G as C,a5 as $e,a6 as Me}from"./vue-fN1Vr7K9.js";import{_ as ze}from"./logo-Ft4BtHHg.js";import{O as Ce,Q as Le,U as qe,V as H,W as Ae,F as Ie,J as Se,T as Ee,G as Te,X as Ue,Y as Be,Z as Pe,H as Ne,$ as Re}from"./antd-DmgnH5Vs.js";var Ve=async(o=0)=>new Promise(r=>{const c=setTimeout(()=>{r(!0),clearTimeout(c)},o)});const Fe={name:"CarbonSun"},He={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32"},Oe=a("path",{fill:"currentColor",d:"M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6ZM5.394 6.813L6.81 5.399l3.505 3.506L8.9 10.319zM2 15.005h5v2H2zm3.394 10.193L8.9 21.692l1.414 1.414l-3.505 3.506zM15 25.005h2v5h-2zm6.687-1.9l1.414-1.414l3.506 3.506l-1.414 1.414zm3.313-8.1h5v2h-5zm-3.313-6.101l3.506-3.506l1.414 1.414l-3.506 3.506zM15 2.005h2v5h-2z"},null,-1),je=[Oe];function Ke(o,r,c,m,h,L){return p(),f("svg",He,je)}const We=T(Fe,[["render",Ke]]),Ye={name:"CarbonMoon"},Ze={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32"},Ge=a("path",{fill:"currentColor",d:"M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3Z"},null,-1),Qe=[Ge];function De(o,r,c,m,h,L){return p(),f("svg",Ze,Qe)}const Je=T(Ye,[["render",De]]),Xe="/assets/login-left-YYnMV6bm.png";function et(o,r=""){var h;const c=((h=le.currentRoute.value)==null?void 0:h.query)??{},m=Ce(c,o)??r;return decodeURIComponent(m)}const t={width:0,height:0,canvas:null,ctx:null,circles:[],animate:!0,requestId:null},tt=function(o){if(!t||!o)throw new Error("no canvasInstance");t.width=window.innerWidth,t.height=window.innerHeight,t.canvas=o,t.canvas.width=t.width,t.canvas.height=t.height,t.ctx=t.canvas.getContext("2d"),t.circles=[];for(let r=0;r<t.width*.5;r++){const c=new ot;t.circles.push(c)}Y(),st()};function K(){t.animate=!(document.body.scrollTop>t.height)}function W(){t.width=window.innerWidth,t.height=window.innerHeight,t.canvas.width=t.width,t.canvas.height=t.height}function Y(){if(t.animate){t.ctx.clearRect(0,0,t.width,t.height);for(const o in t.circles)t.circles[o].draw()}t.requestId=requestAnimationFrame(Y)}class ot{constructor(){v(this,"pos");v(this,"alpha");v(this,"scale");v(this,"velocity");v(this,"draw");this.pos={x:Math.random()*t.width,y:t.height+Math.random()*100},this.alpha=.1+Math.random()*.3,this.scale=.1+Math.random()*.3,this.velocity=Math.random();const r=Math.random()*255,c=Math.random()*255,m=Math.random()*255;this.draw=function(){this.pos.y-=this.velocity,this.alpha-=5e-4,t.ctx.beginPath(),t.ctx.arc(this.pos.x,this.pos.y,this.scale*10,0,2*Math.PI,!1),t.ctx.fillStyle=`rgba(${r},${c},${m},${this.alpha})`,t.ctx.fill()}}}function st(){window.addEventListener("scroll",K),window.addEventListener("resize",W)}function nt(){window.removeEventListener("scroll",K),window.removeEventListener("resize",W),cancelAnimationFrame(t.requestId)}const O={init:tt,removeListeners:nt},U=o=>($e("data-v-e6df4bc5"),o=o(),Me(),o),at={class:"login-container"},rt={"h-screen":"","w-screen":"",absolute:"","z-10":""},it={class:"login-content flex-center"},lt={class:"ant-pro-form-login-main rounded"},ct={class:"flex-between h-15 px-4 mb-[2px]"},dt={class:"flex-end"},ut=U(()=>a("span",{class:"ant-pro-form-login-logo"},[a("img",{"w-full":"","h-full":"","object-cover":"",src:ze})],-1)),pt=U(()=>a("span",{class:"ant-pro-form-login-title"}," Antdv System ",-1)),mt={class:"ant-pro-form-login-desc"},_t={class:"login-lang flex-center relative z-11"},ht={class:"box-border flex min-h-[520px]"},gt=U(()=>a("div",{class:"ant-pro-form-login-main-left min-h-[520px] flex-center bg-[var(--bg-color-container)]"},[a("img",{src:Xe,class:"h-5/6 w-5/6"})],-1)),ft={class:"ant-pro-form-login-main-right px-5 w-[335px] flex-center flex-col relative z-11"},vt={class:"text-center py-2 text-2xl"},wt={flex:"","items-center":""},bt={class:"mb-24px flex-between"},j=60,xt=ge({__name:"login",setup(o){const r=ce(),c=de(),m=ue(),{layoutSetting:h}=fe(m),L=ke(),Z=pe(),s=ve({username:void 0,password:void 0,mobile:void 0,code:void 0,type:"account",remember:!0}),{t:i}=me(),q=k(),x=k(!1),A=k(!1),I=k(!1),B=we(),{counter:G,pause:Q,reset:D,resume:J,isActive:P}=be(1e3,{controls:!0,immediate:!1,callback(g){g&&g===j&&Q()}});async function X(){x.value=!0;try{await q.value.validate(["mobile"]),setTimeout(()=>{D(),J(),x.value=!1,r.success("验证码是：123456")},3e3)}catch{x.value=!1}}async function w(){var g;A.value=!0;try{await((g=q.value)==null?void 0:g.validate());let l;s.type==="account"?l={username:s.username,password:s.password}:l={mobile:s.mobile,code:s.code,type:"mobile"};const{data:b}=await _e(l);Z.value=b==null?void 0:b.token,c.success({message:"登录成功",description:"欢迎回来！",duration:3});const S=et("redirect","/");L.push({path:S,replace:!0})}catch(l){l instanceof he&&(I.value=!0),A.value=!1}}return xe(async()=>{await Ve(300),O.init(e(B))}),ye(()=>{O.removeListeners()}),(g,l)=>{const b=Je,S=We,ee=ie,N=Ie,R=Se,te=Ee,V=Te,E=Ue,y=Be,oe=Pe,F=Ne,se=Re,ne=Le;return p(),f("div",at,[a("div",rt,[a("canvas",{ref_key:"bubbleCanvas",ref:B},null,512)]),a("div",it,[a("div",lt,[a("div",ct,[a("div",dt,[ut,pt,a("span",mt,_(e(i)("pages.layouts.userLayout.title")),1)]),a("div",_t,[a("span",{class:"flex-center cursor-pointer text-16px",onClick:l[0]||(l[0]=u=>e(m).toggleTheme(e(h).theme==="dark"?"light":"dark"))},[e(h).theme==="light"?(p(),$(b,{key:0})):(p(),$(S,{key:1}))]),n(ee)])]),n(N,{"m-0":""}),a("div",ht,[gt,n(N,{"m-0":"",type:"vertical",class:"ant-pro-login-divider min-h-[520px]"}),a("div",ft,[a("div",vt,_(e(i)("pages.login.tips")),1),n(ne,{ref_key:"formRef",ref:q,model:e(s)},{default:d(()=>[n(te,{activeKey:e(s).type,"onUpdate:activeKey":l[1]||(l[1]=u=>e(s).type=u),centered:""},{default:d(()=>[n(R,{key:"account",tab:e(i)("pages.login.accountLogin.tab")},null,8,["tab"]),n(R,{key:"mobile",tab:e(i)("pages.login.phoneLogin.tab")},null,8,["tab"])]),_:1},8,["activeKey"]),e(I)&&e(s).type==="account"?(p(),$(V,{key:0,"mb-24px":"",message:e(i)("pages.login.accountLogin.errorMessage"),type:"error","show-icon":""},null,8,["message"])):M("",!0),e(I)&&e(s).type==="mobile"?(p(),$(V,{key:1,"mb-24px":"",message:e(i)("pages.login.phoneLogin.errorMessage"),type:"error","show-icon":""},null,8,["message"])):M("",!0),e(s).type==="account"?(p(),f(z,{key:2},[n(y,{name:"username",rules:[{required:!0,message:e(i)("pages.login.username.required")}]},{default:d(()=>[n(E,{value:e(s).username,"onUpdate:value":l[2]||(l[2]=u=>e(s).username=u),"allow-clear":"",autocomplete:"off",placeholder:e(i)("pages.login.username.placeholder"),size:"large",onPressEnter:w},{prefix:d(()=>[n(e(qe))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),n(y,{name:"password",rules:[{required:!0,message:e(i)("pages.login.password.required")}]},{default:d(()=>[n(oe,{value:e(s).password,"onUpdate:value":l[3]||(l[3]=u=>e(s).password=u),"allow-clear":"",placeholder:e(i)("pages.login.password.placeholder"),size:"large",onPressEnter:w},{prefix:d(()=>[n(e(H))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"])],64)):M("",!0),e(s).type==="mobile"?(p(),f(z,{key:3},[n(y,{name:"mobile",rules:[{required:!0,message:e(i)("pages.login.phoneNumber.required")},{pattern:/^(86)?1([38][0-9]|4[579]|5[0-35-9]|6[6]|7[0135678]|9[89])[0-9]{8}$/,message:e(i)("pages.login.phoneNumber.invalid")}]},{default:d(()=>[n(E,{value:e(s).mobile,"onUpdate:value":l[4]||(l[4]=u=>e(s).mobile=u),"allow-clear":"",placeholder:e(i)("pages.login.phoneNumber.placeholder"),size:"large",onPressEnter:w},{prefix:d(()=>[n(e(Ae))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),n(y,{name:"code",rules:[{required:!0,message:e(i)("pages.login.captcha.required")}]},{default:d(()=>[a("div",wt,[n(E,{value:e(s).code,"onUpdate:value":l[5]||(l[5]=u=>e(s).code=u),style:{flex:"1 1 0%",transition:"width 0.3s ease 0s","margin-right":"8px"},"allow-clear":"",placeholder:e(i)("pages.login.captcha.placeholder"),size:"large",onPressEnter:w},{prefix:d(()=>[n(e(H))]),_:1},8,["value","placeholder"]),n(F,{loading:e(x),disabled:e(P),size:"large",onClick:X},{default:d(()=>[e(P)?(p(),f(z,{key:1},[C(_(j-e(G))+" "+_(e(i)("pages.getCaptchaSecondText")),1)],64)):(p(),f(z,{key:0},[C(_(e(i)("pages.login.phoneLogin.getVerificationCode")),1)],64))]),_:1},8,["loading","disabled"])])]),_:1},8,["rules"])],64)):M("",!0),a("div",bt,[n(se,{checked:e(s).remember,"onUpdate:checked":l[6]||(l[6]=u=>e(s).remember=u)},{default:d(()=>[C(_(e(i)("pages.login.rememberMe")),1)]),_:1},8,["checked"]),a("a",null,_(e(i)("pages.login.forgotPassword")),1)]),n(F,{type:"primary",block:"",loading:e(A),size:"large",onClick:w},{default:d(()=>[C(_(e(i)("pages.login.submit")),1)]),_:1},8,["loading"])]),_:1},8,["model"])])])])])])}}}),Lt=T(xt,[["__scopeId","data-v-e6df4bc5"]]);export{Lt as default};
